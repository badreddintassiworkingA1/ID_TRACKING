<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ID Tracking</title>
</head>
<body>
    <textarea id="inputArea" rows="10" cols="50" placeholder="Paste your text here..."></textarea><br>
    <button onclick="analyze()">Analyze</button>
    <div id="resultDiv"></div>

    <script>
        let idList = {}; // Ø³ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„Ù‡Ø§ Ù…Ù† Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠ

        // ØªØ­Ù…ÙŠÙ„ idList.json Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        fetch('idList.json')
            .then(response => response.json())
            .then(data => {
                idList = data;
                console.log("âœ… idList loaded:", idList);
            })
            .catch(error => {
                console.error("âŒ Failed to load idList.json", error);
            });

        function generateVariants(str, ignoreChars) {
            let results = [];

            function helper(current, remaining) {
                if (remaining.length === 0) {
                    results.push(current);
                    return;
                }
                let char = remaining[0];
                let rest = remaining.slice(1);

                if (ignoreChars.includes(char)) {
                    helper(current, rest);
                }
                helper(current + char, rest);
            }

            helper('', str);
            return results;
        }

        function analyze() {
            const inputText = document.getElementById("inputArea").value;
            const resultDiv = document.getElementById("resultDiv");

            // ØªØ£ÙƒØ¯ Ù…Ù† ØªØ­Ù…ÙŠÙ„ idList
            if (Object.keys(idList).length === 0) {
                resultDiv.innerHTML = `â³ Please wait... Loading ID list.`;
                return;
            }

            let matchedId = null;
            let suggestedId = null;

            let parts = inputText.split("Your ID:");
            if (parts.length < 2) {
                resultDiv.innerHTML = "âŒ Could not find 'Your ID:' in the input.";
                return;
            }

            let encryptedPart = parts[1].trim(); 
            let ignoreChars = ["l", "r", "a", "u", "g", "p", "m", "s", "c", "d", "i"];
            let possibleVariants = generateVariants(encryptedPart, ignoreChars);

            for (let variant of possibleVariants) {
                for (let id of Object.keys(idList)) {
                    if (variant.includes(id) || variant.split("").reverse().join("").includes(id)) {
                        matchedId = id;
                        break;
                    }
                }
                if (matchedId) break;
            }

            if (matchedId) {
                resultDiv.innerHTML = `âœ… Matching ID: ${matchedId} (${idList[matchedId]})`;
            } else {
                // Suggest ID and also reverse the suggested ID
                suggestedId = possibleVariants[0]; // Choose the first possible variant for the suggestion
                resultDiv.innerHTML = `âŒ No matching ID found<br>ğŸ” Suggested ID: ${suggestedId} or ${suggestedId.split("").reverse().join("")}`;
            }
        }
    </script>
</body>
</html>
