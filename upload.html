<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Upload JSON to Firestore</title>
</head>
<body>
  <h2>📤 رفع بيانات Email Lists إلى Firestore</h2>
  <textarea id="jsonData" placeholder="ألصق هنا بيانات JSON" style="width:100%;height:200px;"></textarea>
  <br><br>
  <button onclick="uploadData()">🚀 ارفع الآن</button>

  <!-- Firebase SDKs -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.11/firebase-app.js";
    import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/9.6.11/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBTMu-iEZODJ-VWc6SdhxrR87WJV4n9D3Y",
      authDomain: "seed-38e79.firebaseapp.com",
      projectId: "seed-38e79"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    window.uploadData = async function () {
      const textarea = document.getElementById("jsonData");
      let data;
      try {
        data = JSON.parse(textarea.value);
      } catch (err) {
        alert("⚠️ صيغة JSON غير صحيحة");
        return;
      }

      const promises = [];

      for (const system in data) {
        const ref = doc(db, "emailLists", system);
        const content = data[system];
        promises.push(setDoc(ref, content));
      }

      try {
        await Promise.all(promises);
        alert("✅ تم رفع البيانات بنجاح إلى Firestore");
      } catch (error) {
        console.error("❌ خطأ في الرفع:", error);
        alert("⚠️ حدث خطأ أثناء رفع البيانات.");
      }
    }
  </script>
</body>
</html>

